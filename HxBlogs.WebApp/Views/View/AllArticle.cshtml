@{
    ViewBag.Title ="全部文章 - " + ViewBag.User.UserName + " - 海·星の博客";
}
@section styles{
    @Styles.Render("~/content/default")
}
<div class="hx-container blog-view">
    <div class="d-flex">
        @{
            Html.RenderPartial("side", ViewBag.User as HxBlogs.Model.User);
        }
        <article class="flex-fill overflow-hidden">
            <div class="mt-2 ml-2 hx-white-container partial-content" data-url="/article/@ViewBag.User.UserName/allarticle" hidden>
            </div>
        </article>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        $(function () {
            loadPartial();
            $(".partial-content").on('click', '.hx-a', function () {
                var $me = $(this),
                    id = $me.data('id'),
                    url = $me.data('url');
                if (HxCore.isEmpty(url)) return;
                alertify.confirm(`确定要${$me.text()}当前文章?`, function () {
                    HxCore.ajax(url, {
                        data: {
                            id: id
                        },
                        success(data) {
                            loadPartial();
                            HxCore.remindSuccess(data);
                        }
                    });
                });
            });
        });
        function loadPartial() {
            $(".partial-content").each(function (index, item) {
                var url = $(item).data("url");
                if (url && url.length > 0) {
                    $(item).load(url, function (response, status, xhr) {
                        if (status == 'success') {
                            $(this).removeAttr('hidden');
                        } else {
                            HxCore.ajaxError(xhr);
                        }
                    });
                }
            })
        }
    </script>
}
